<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <title>Add Item Form</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(90deg, #4e54c8 0%, #8f94fb 100%);
            color: #fff;
            margin: 0;
            padding: 0;
        }

        .container {
            margin-top: 30px;
        }

        h2 {
            text-align: center;
            margin-bottom: 30px;
        }

        .add-item-btn {
            background-color: #3498db;
            color: #fff;
        }

        .add-item-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            padding: 20px;
        }

        .add-item-modal img {
            width: 100%;
            height: auto;
        }

        .close-btn {
            background-color: #6c757d;
            color: #fff;
        }

        .close-btn:hover {
            background-color: #495057;
        }
    </style>
</head>


<body>

<div class="container">
  <div class="container">
    <h2>Item List</h2>

    <form id="itemListForm" action="/submitItemList" method="post">
      <!-- Use Thymeleaf to iterate over items -->
      <div th:each="item, itemStat : ${items}">
        <!-- Use Thymeleaf expressions for input names -->
        <input type="hidden" th:name="items[__${itemStat.index}__].id" th:value="${item.id}" />
        <input type="hidden" th:name="items[__${itemStat.index}__].itemLongLabel" th:value="${item.itemLongLabel}" />
        <input type="hidden" th:name="items[__${itemStat.index}__].itemBlueprint" th:value="${item.itemBlueprint}" />
        <input type="hidden" th:name="items[__${itemStat.index}__].itemPaintable" th:value="${item.itemPaintable}" />
        <input type="hidden" th:name="items[__${itemStat.index}__].itemType" th:value="${item.itemType}" />
      </div>

      <!-- Submit the form with a button -->
      <button type="submit" class="btn btn-primary">Submit Item List</button>
    </form>

    <!-- Item List -->
      <div class="row">
        <div th:each="item : ${items}" class="col-md-4">
          <div class="rlg-item__container is--import">
            <!-- Display each item in the list -->
            <img class="rlg-item__itemimage"
                 th:src="'https://raw.githubusercontent.com/enzanki-ars/rocket-league-item-images/enzanki-ars/Rocket%20League%20Item%20Images/'
                                            + ${item.itemType} + '/' + ${item.itemLongLabel.replace(' ', '%20')} + '/Default.png'"
                 alt="Item Image" loading="lazy">
            <h2 class="--new" th:text="${item.itemLongLabel}"></h2>
          </div>
        </div>
      </div>

      <button type="button" class="btn add-item-btn" onclick="openAddItemModal()">Add Item</button>


      <!-- Add Item Modal -->
      <div class="add-item-modal" id="addItemModal">
        <h2>Select Item</h2>
        <!-- Display a list of items to choose from -->
        <!-- Replace the following line with your dynamic Thymeleaf content -->
        <div th:each="item : ${allItems}">
          <div class="rlg-item__container">
            <a href="#" class="rlg-items-item no-blur" onclick="addItemToList('${item.id}', '${item.itemLongLabel}')">
              <img class="rlg-item__itemimage"
                   th:src="'https://raw.githubusercontent.com/enzanki-ars/rocket-league-item-images/enzanki-ars/Rocket%20League%20Item%20Images/'
                                                + ${item.itemType} + '/' + ${item.itemLongLabel.replace(' ', '%20')} + '/Default.png'"
                   alt="Item Image" loading="lazy">
              <h2 class="--new" th:text="${item.itemLongLabel}"></h2>
            </a>
          </div>
        </div>
        <button class="btn close-btn" onclick="closeAddItemModal()">Close</button>
      </div>

      <!-- Submit Button -->
      <button type="submit" class="btn btn-primary">Submit Item List</button>
<!--    </form>-->
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<!-- ... (previous HTML content remains unchanged) ... -->

<script>
        function openAddItemModal() {
            document.getElementById('addItemModal').style.display = 'block';
        }

        function closeAddItemModal() {
            document.getElementById('addItemModal').style.display = 'none';
        }

        function addItemToList(itemId, itemName) {
            // Create a new item object
            var newItem = {
                id: itemId,
                itemLongLabel: itemName,
                itemType: 'type_placeholder' // Replace with actual type
                // Add more properties if needed
            };

            // Add the new item to the list
            items.push(newItem);

            // Update the displayed list
            updateItemList();

            // Update the hidden input field with the current items data
            document.getElementById('itemsInput').value = JSON.stringify(items);

            // Close the modal
            closeAddItemModal();
        }

        function updateItemList() {
            // Get the container for displaying items
            var itemListContainer = document.querySelector('.row');

            // Clear existing items
            itemListContainer.innerHTML = '';

            // Iterate through the items and display each one
            items.forEach(function (item) {
                var itemContainer = document.createElement('div');
                itemContainer.className = 'col-md-4 rlg-item__container is--import';

                var itemImage = document.createElement('img');
                itemImage.className = 'rlg-item__itemimage';
                itemImage.src = 'https://raw.githubusercontent.com/enzanki-ars/rocket-league-item-images/enzanki-ars/Rocket%20League%20Item%20Images/' +
                    item.itemType + '/' + item.itemLongLabel.replace(' ', '%20') + '/Default.png';
                itemImage.alt = 'Item Image';
                itemImage.loading = 'lazy';

                var itemNameElement = document.createElement('h2');
                itemNameElement.className = '--new';
                itemNameElement.innerText = item.itemLongLabel;

                itemContainer.appendChild(itemImage);
                itemContainer.appendChild(itemNameElement);

                itemListContainer.appendChild(itemContainer);
            });
        }

        // Initial items array (you can load this from server-side or initialize it as needed)
        var items = [];
        // Call updateItemList to display the initial list
        updateItemList();
    </script>

<!-- Add a hidden input field to store the items data -->
<input type="hidden" name="items" id="itemsInput" th:value="${items}" />


</body>

</html>

